<script>
  const card = document.getElementById('flashcard');
  const avatar = document.getElementById('avatar');
  const instructorLabel = document.getElementById('instructor-label');
  const subtitleContainer = document.getElementById('subtitles');
  const hint = document.getElementById('hint');

  let flashcards = [];
  let index = 0;

  function updateSlide() {
    card.style.transform = 'rotateY(180deg)';
    setTimeout(() => {
      const content = flashcards[index];
      card.textContent = content;
      card.style.transform = 'rotateY(0deg)';

      const isFirst = index === 0;
      const isLast = index === flashcards.length - 1;

      avatar.classList.toggle('small', !isFirst && !isLast);
      instructorLabel.style.display = (!isFirst && !isLast) ? 'block' : 'none';
      subtitleContainer.style.display = isFirst ? 'flex' : 'none';

      if (isLast) {
        hint.innerHTML = `üî• Tap again to support Kingdom tech`;
        // Add final click to redirect
        card.onclick = () => {
          window.location.href = "https://dashboard.givebutter.com/accounts/48223/campaigns/396190";
        };
      } else {
        hint.textContent = 'Tap the card to reveal the next flash üîÑ';
        index++;
      }

      card.style.fontSize = content.length > 180 ? '1em' : '1.2em';
    }, 300);
  }

  card.addEventListener('click', updateSlide);

  // Load flashcards based on filename
  const pageName = location.pathname.split("/").pop().replace(".html", "").toLowerCase();
  fetch(`flashcards/${pageName}.json`)
    .then(res => res.json())
    .then(data => {
      const courseTitle = data[0];
      const contentSlides = data.slice(1);

      flashcards = [
        `üëã ${courseTitle}`,
        ...contentSlides,
        `üéâ Thank you for reading!\n${courseTitle}.\nI hope it blessed you!`,
        `üí¨ Wanna help us build Kingdom tech? üöÄ\n\nJust $5/month gets me more server space ‚Äî which lets me spread more messages, reach more hearts, and fuel the hearts of man with fire from God üôåüèæ`
      ];

      card.textContent = flashcards[0];
    })
    .catch(err => {
      console.error("Could not load flashcards:", err);
      card.textContent = "‚ö†Ô∏è Could not load flashcards";
    });
</script>
